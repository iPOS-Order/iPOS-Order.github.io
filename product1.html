<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" media="all">
  <!-- 網路上的sidebar原始黨 -->
  <link rel="stylesheet" href="css/sidebar.css" type="text/css" media="all">
  <!--- 客製化css都在這 -->
  <link rel="stylesheet" href="css/layout.css" type="text/css" media="all">


  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="js/jquery-1.11.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <!-- <script src="https://kit.fontawesome.com/28b38896b0.js" crossorigin="anonymous"></script> -->
  <script src="js/all.min.js"></script>
  <title>Demo</title>
</head>

<body>
  <header>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
      <a class="navbar-brand" href="#"></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
        aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html"><i class="fa fa-home"></i> 回首頁</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="product3.html"><i class="fa fa-utensils"></i> 全部</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="product2.html"><i class="fa fa-pepper-hot"></i> 辣味咖哩飯</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="product1.html"><i class="fa fa-child"></i> 兒童餐</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="product.html"><i class="fa fa-glass-cheers"></i> 飲料</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="order-info.html"><i class="fa fa-list"></i> 點餐紀錄</a>
          </li>
          <!-- <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
          </li> -->
          <!-- <li class="nav-item">
            <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
          </li> -->
        </ul>
        <!-- <form class="form-inline mt-2 mt-md-0">
          <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form> -->
      </div>
      <div class="cart cart box_1" id="view-cart">
        <form action="#" method="post" class="last">
          <input type="hidden" name="cmd" value="_cart">
          <input type="hidden" name="display" value="1">
          <button class="shopping-cart" type="button" name="submit" value=""><i class="fa fa-cart-arrow-down"
              aria-hidden="true"></i></button>
        </form>
        <div id="cart-number">0</div>
      </div>
    </nav>
  </header>
  <main role="main" class="flex-shrink-0">
    <!-- loading -->
    <div class="load-bg">
      <div id="loader"></div>
    </div>
    <div id="wrapper" class="toggled">
      <!-- Sidebar -->
      <div id="sidebar-wrapper">
        <div class="top-content">
          <div class="desk-number">
            桌號: 22號
          </div>
          <div class="order-content">

          </div>
        </div>
        <div class="bottom-content">
          <ul class="bottom-sidebar-nav">
            <li class="sidebar-button"> <a id="confirm-order-btn" href="shopping-cart.html"> 確認點餐 </a> </li>
          </ul>
        </div>
      </div> <!-- /#sidebar-wrapper -->
    </div> <!-- /#wrapper -->
    <div class="container">
      <div class="row">
        <div class="col-lg-4 col-md-6 col-sm-12">
          <div class="product-grid"
            onclick="location.href='prodcut_detail.html?pid=kali3&name=皮卡丘咖哩定食&displayname=皮卡丘咖哩定食(造型咖哩飯 、 味增湯 、 茶碗蒸 )&price=250'">
            <div class="product-image">
              <a href="prodcut_detail.html?pid=kali3&name=皮卡丘咖哩定食&displayname=皮卡丘咖哩定食(造型咖哩飯 、 味增湯 、 茶碗蒸 )&price=250">
                <img class="pic-1" src="images/kali3.jpg">
                <!-- <img class="pic-2" src="images/kali3.jpg"> -->
              </a>
              <!-- <ul class="social">
                            <li><a href="#" data-tip="Quick View"><i class="fas fa-eye"></i></a></li>
                            <li><a href="#" data-tip="Add to Wishlist"><i class="fas fa-shopping-bag"></i></a></li>
                            <li><a href="#" data-tip="Add to Cart"><i class="fas fa-shopping-cart"></i></a></li>
                        </ul> -->
              <!-- <span class="product-discount-label">-12%</span> -->
            </div>
            <div class="product-content">
              <h3 class="title"><a
                  href="prodcut_detail.html?pid=kali3&name=皮卡丘咖哩定食&displayname=皮卡丘咖哩定食(造型咖哩飯 、 味增湯 、 茶碗蒸 )&price=250">皮卡丘咖哩定食</a>
              </h3>
              <!-- <div class="detail">造型咖哩飯，加入蜂蜜、水果等食材，適合小孩吃</div> -->
              <div class="price">
                $250
                <span>$300</span>
              </div>
              <!-- <a class="add-to-cart" data-price="250" data-name="皮卡丘咖哩定食" data-pid="kali3" href="javascript:void(0);"
                data-tip="Add to Cart"><i class="fa fa-shopping-cart"></i></a> -->
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 col-sm-12">
          <div class="product-grid"
            onclick="location.href='prodcut_detail.html?pid=kali7&name=熊熊咖哩定食&displayname=熊熊咖哩定食(造型咖哩飯 、 味增湯 、 茶碗蒸 )&price=250'">
            <div class="product-image">
              <a href="prodcut_detail.html?pid=kali7&name=熊熊咖哩定食&displayname=熊熊咖哩定食(造型咖哩飯 、 味增湯 、 茶碗蒸 )&price=250">
                <img class="pic-1" src="images/kali7.jpg">
                <!-- <img class="pic-2" src="images/kali7.jpg"> -->
              </a>
              <!-- <ul class="social">
                            <li><a href="#" data-tip="Quick View"><i class="fas fa-eye"></i></a></li>
                            <li><a href="#" data-tip="Add to Wishlist"><i class="fas fa-shopping-bag"></i></a></li>
                            <li><a href="#" data-tip="Add to Cart"><i class="fas fa-shopping-cart"></i></a></li>
                        </ul> -->
              <!-- <span class="product-discount-label">-12%</span> -->
            </div>
            <div class="product-content">
              <h3 class="title"><a
                  href="prodcut_detail.html?pid=kali7&name=熊熊咖哩定食&displayname=熊熊咖哩定食(造型咖哩飯 、 味增湯 、 茶碗蒸 )&price=250">熊熊咖哩定食</a>
              </h3>
              <!-- <div class="detail">造型咖哩飯，加入蜂蜜、水果等食材，適合小孩吃</div> -->
              <div class="price">
                $250
                <span>$300</span>
              </div>
              <!-- <a class="add-to-cart" data-price="250" data-name="熊熊咖哩定食" data-pid="kali7" href="javascript:void(0);"
                data-tip="Add to Cart"><i class="fa fa-shopping-cart"></i></a> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</body>

</html>
<script>
  $(function () {
    // loading mask
    $('a').click(function () {
      $('.load-bg').show();
    });
    $('.product-grid').click(function () {
      $('.load-bg').show();
    });
    // 亂數取桌號
    if (window.localStorage.getItem("desk-number") == null) {
      var desk_number = Math.floor(Math.random() * 50)
      window.localStorage.setItem("desk-number", desk_number);
    }

    $('.desk-number').html('桌號: ' + window.localStorage.getItem("desk-number") + '號');
    var cart_total_number = 0
    var cart_data = JSON.parse(window.localStorage.getItem("cart-food-data"))
    var cart_content = ''
    if (window.localStorage.getItem("cart-food-data") != null) {
      $(cart_data).each(function (index) {
        cart_total_number = cart_total_number + cart_data[index].num
        cart_content += '<div class="cart-content">\
                            <img src="images/'+ cart_data[index].pid + '.jpg" alt="kali">\
                            <span>'+ cart_data[index].name + ' * ' + cart_data[index].num + '</span>\
                        </div>'
      })
      $('#cart-number').html(cart_total_number);
      $('#cart-number').show();
      $('.order-content').html(cart_content);
    }
  })
  $('#view-cart').click(function () {
    $('.load-bg').show();
    window.location.href = 'shopping-cart.html';
  });
  $('.add-to-cart').click(function () {
    var pid = $(this).data('pid');
    var name = $(this).data('name');
    var price = $(this).data('price');
    var content = '';
    // window.localStorage.clear();
    if (window.localStorage.getItem("cart-food-data") != null) {
      var arr_obj_param = { 'pid': pid, 'name': name, 'price': price, 'num': 1 };
      var temp_array = [];
      var obj_res = JSON.parse(window.localStorage.getItem("cart-food-data"));
      var count = 0;
      var total = 0;
      $(obj_res).each(function (index) {

        if (obj_res[index].pid == pid) {
          var number = obj_res[index].num + 1;
          temp_array.push({ 'pid': pid, 'name': name, 'price': price, 'num': number });
          count++;
          total = number + total;
          content += '<div class="cart-content">\
                          <img src="images/'+ pid + '.jpg" alt="kali">\
                          <span>'+ name + ' * ' + number + '</span>\
                      </div>'
        }
        else {

          temp_array.push(obj_res[index]);
          total = obj_res[index].num + total;
          content += '<div class="cart-content">\
                          <img src="images/'+ obj_res[index].pid + '.jpg" alt="kali">\
                          <span>'+ obj_res[index].name + ' * ' + obj_res[index].num + '</span>\
                      </div>'

        }

      });
      // console.log(count);
      if (count == 0) {
        content += '<div class="cart-content">\
                          <img src="images/'+ pid + '.jpg" alt="kali">\
                          <span>'+ name + ' * 1</span>\
                      </div>'
        total = 1 + total
        obj_res.push(arr_obj_param);
        // console.log(obj_res);
        window.localStorage.setItem("cart-food-data", JSON.stringify(obj_res));
      }
      else {
        // console.log(temp_array);
        window.localStorage.setItem("cart-food-data", JSON.stringify(temp_array));
      }
      // $('#view-cart').addClass('animated infinite bounce');
      // setTimeout(
      //     function () {
      //         $('#view-cart').removeClass('animated infinite bounce')
      //     }, 2000);
      $('#cart-number').html(total);
      $('.order-content').html(content);
    }
    else {
      var arr_obj_param = [{ 'pid': pid, 'name': name, 'price': price, 'num': 1 }];
      window.localStorage.setItem("cart-food-data", JSON.stringify(arr_obj_param))
      content += '<div class="cart-content">\
                          <img src="images/'+ pid + '.jpg" alt="kali">\
                          <span>'+ name + ' * 1</span>\
                      </div>'
      $('#cart-number').html(1);
      $('#cart-number').show();
      $('.order-content').html(content);
    }
  })
</script>